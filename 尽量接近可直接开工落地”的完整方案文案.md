# 1. 方案总览

## 1.1 一句话架构

**DXcam（ROI 高性能截屏） → 变化检测（跳帧） → RapidOCR(ONNXRuntime)（英文 OCR） → 文本去抖/缓存 → 本地翻译（默认 Argos；可选 CTranslate2+OPUS/Marian） → PySide6 透明置顶叠加显示**。

- DXcam：Windows 高性能捕获，支持 `region=(left, top, right, bottom)` 截取指定区域；项目声明使用 Desktop Duplication API，许可证 MIT。[GitHub+1](https://github.com/ra1nty/DXcam)
- RapidOCR：工程化 OCR 方案，强调 ONNXRuntime 等多后端，项目 Apache-2.0（模型版权另行说明）。[GitHub+1](https://github.com/RapidAI/RapidOCR?utm_source=chatgpt.com)
- Argos Translate：离线翻译，支持 `.argosmodel` 模型包；并提供 `ARGOS_DEVICE_TYPE=cuda` 的 GPU 开关（本质把设备类型传给 CTranslate2）。[PyPI+1](https://pypi.org/project/argostranslate/?utm_source=chatgpt.com)
- PySide6/Qt：透明窗口用 `Qt.WA_TranslucentBackground` + `Qt.FramelessWindowHint`；鼠标穿透用 `Qt.WindowTransparentForInput` 或 `Qt.WA_TransparentForMouseEvents`。[Qt Documentation+1](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)

## 1.2 交付形态

- **桌面应用（exe）**：系统托盘常驻，热键呼出，选区后开始实时翻译。
- **两种显示模式**：
  1. **字幕条模式（推荐默认）**：在 ROI 下方/屏幕底部显示译文，稳定易用。
  2. **贴近区域浮窗模式**：ROI 边缘显示可滚动译文窗，适合长句/段落。

------

# 2. 需求定义（“完美”的关键：明确体验指标）

## 2.1 功能需求（必须）

1. **选区**：热键进入选区模式，拖拽矩形保存 ROI（屏幕坐标）。
2. **实时 OCR**：对 ROI 画面做英文识别，输出文本（多行合并）。
3. **实时翻译**：英文→简体中文，离线运行。
4. **叠加显示**：透明置顶，不抢焦点；默认鼠标穿透；可一键切换“可交互（用于拖动/复制）”。
5. **热键**：开始/暂停、重新选区、切换显示模式、复制译文、调字体大小、显示/隐藏叠加层。
6. **配置持久化**：ROI、窗口位置、字体、OCR 阈值、翻译引擎、缓存大小等写入本地配置文件。
7. **日志与诊断**：可选 debug 模式输出：FPS、OCR 耗时、翻译耗时、最后一次识别文本与译文。

## 2.2 非功能指标（建议验收标准）

- **端到端延迟**（字幕场景）：< 300ms（中端 CPU 也能做到，靠跳帧+缓存）。
- **稳定刷新频率**：识别/翻译输出 3–10 次/秒足够“看起来实时”；捕获可以 30–60fps，但不需要每帧都 OCR。
- **CPU 占用**：CPU-only 模式下保持可用（允许峰值），并提供节能档位（降低 OCR 频率）。
- **离线**：默认无网络依赖（仅模型更新时可联网）。

------

# 3. 技术选型（最终推荐）

## 3.1 捕获（ROI 截屏）

- **主选：DXcam**
  - 支持通过 `region=(left, top, right, bottom)` 截取指定区域。[GitHub](https://github.com/ra1nty/DXcam?utm_source=chatgpt.com)
  - GitHub 项目说明：用于 Windows，基于 Desktop Duplication API，MIT license。[GitHub](https://github.com/ra1nty/DXcam)
- **可选增强：BetterCam**
  - 宣称可达 240Hz+ 捕获，适合极限低延迟/高刷场景（游戏字幕）。[GitHub](https://github.com/RootKit-Org/BetterCam?utm_source=chatgpt.com)
  - 建议作为“可插拔 backend”，别一开始就依赖。

## 3.2 OCR（英文识别）

- **主选：rapidocr-onnxruntime（RapidOCR 的 ONNXRuntime 版）**
  - PyPI 说明：基于 ONNXRuntime 的跨平台 OCR。[PyPI+1](https://pypi.org/project/rapidocr-onnxruntime/?utm_source=chatgpt.com)
  - RapidOCR GitHub：工程脚本 Apache-2.0，并说明 OCR 模型版权归属（需要在合规文件里列出）。[GitHub](https://github.com/RapidAI/RapidOCR?utm_source=chatgpt.com)
  - RapidOCR 示例代码显示典型用法：`RapidOCR(...)` 初始化，并在推理调用里传 `box_thresh/unclip_ratio/text_score` 等参数。[Hugging Face](https://huggingface.co/spaces/RapidAI/RapidOCR/resolve/main/app.py?download=true&utm_source=chatgpt.com)

## 3.3 翻译（离线）

- **默认（最快上线）：Argos Translate**
  - PyPI/官网说明：离线翻译，使用 OpenNMT，并支持安装 `.argosmodel` 模型包。[PyPI+1](https://pypi.org/project/argostranslate/?utm_source=chatgpt.com)
  - GPU 可选：设置 `ARGOS_DEVICE_TYPE=cuda`（把 device 类型传给 CTranslate2）。[PyPI](https://pypi.org/project/argostranslate/1.4.0/?utm_source=chatgpt.com)
- **增强（更低延迟/可量化）：CTranslate2**
  - CTranslate2 是高效 Transformer 推理引擎，支持权重量化、层融合等优化。[GitHub](https://github.com/OpenNMT/CTranslate2?utm_source=chatgpt.com)
  - 量化文档：支持 `int8/int16/float16` 等。[GitHub](https://github.com/OpenNMT/CTranslate2/blob/master/docs/quantization.md?utm_source=chatgpt.com)
  - 性能建议：可把 `beam_size=1`、关掉不需要的 score，并合理设置 batch。[OpenNMT+1](https://opennmt.net/CTranslate2/performance.html?utm_source=chatgpt.com)
  - 模型建议：可用 OPUS/Marian 系列（例如 en→zh 的 OPUS-MT 模型在 HF 配置文件里标注 license: apache-2.0）。[Hugging Face](https://huggingface.co/Helsinki-NLP/opus-mt-en-zh/blob/main/config.json?utm_source=chatgpt.com)

## 3.4 UI（叠加层/选区层/托盘）

- **PySide6（Qt for Python）**
  - 透明背景：`Qt.WA_TranslucentBackground`（Windows 上还需要 FramelessWindowHint）。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
  - 置顶：`Qt.WindowStaysOnTopHint`。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
  - 真正“输入穿透”的窗口标志：`Qt.WindowTransparentForInput`（文档说明它让输入事件像窗口不存在一样穿透；并提示 Windows 上仅对无边框或全屏窗口有效）。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
  - 组件级鼠标穿透：`Qt.WA_TransparentForMouseEvents`。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)

------

# 4. 关键工程点（完美体验的“硬门槛”）

## 4.1 高 DPI / 多屏坐标一致性（必须解决）

**问题**：Windows 缩放（125%/150%）会导致 ROI 选区坐标与 DXcam 捕获坐标不一致（偏移/缩放错误）。

**推荐做法：用 Manifest 设置进程 DPI Awareness（优先）**

- Microsoft 文档建议：默认 DPI awareness 最推荐通过**应用清单（manifest）**设置，而不是运行时 API 调用。[Microsoft Learn+1](https://learn.microsoft.com/en-us/windows/win32/hidpi/setting-the-default-dpi-awareness-for-a-process?utm_source=chatgpt.com)
- Manifest 中 DPI aware 的写法与含义可以参考 Windows 的 manifests 说明（含 `true/pm`、`per monitor` 等）。[Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/sbscs/application-manifests?utm_source=chatgpt.com)

**兜底做法（开发期/兼容性）：启动最早期用 ctypes 调用 DPI API**

- 注意：微软也明确说“更推荐 manifest”，API 方式可能带来不可预期行为。[Microsoft Learn+1](https://learn.microsoft.com/en-us/windows/win32/api/shellscalingapi/nf-shellscalingapi-setprocessdpiawareness?utm_source=chatgpt.com)
   （所以我建议：开发期可以临时 API，发布版走 manifest。）

------

## 4.2 线程模型：不要让 OCR/翻译阻塞 UI

推荐“四线程 + 最新值缓存”模型（核心：永远处理最新帧，不积压）：

1. **CaptureThread**：DXcam 持续抓 ROI 帧 → 写入 `latest_frame`（覆盖旧帧）。
2. **OcrThread**：定时取 `latest_frame`，先做变化检测；变化明显才 OCR → 输出 `latest_text`。
3. **TranslateThread**：监听 `latest_text` 的变化，命中缓存直接返回，否则翻译 → 输出 `latest_translation`。
4. **UI(MainThread)**：只负责渲染；收到“译文更新”信号就刷新显示。

> 为什么不用队列堆帧？
>  实时场景里堆队列只会越堆越慢，体感“越翻越延迟”。你要的是“现在这一帧/这一句”。

------

## 4.3 变化检测 + 文本去抖（决定 CPU 和稳定性）

**变化检测（跳帧）建议策略**：

- 把 ROI 图缩到例如 64×64 灰度，计算 `mean(abs(curr-prev))`；低于阈值就跳过 OCR。
- 额外策略：如果上一帧 OCR 为空/很短，可降低阈值以避免漏检。

**文本去抖（避免闪烁）**：

- 对 OCR 文本做 normalize：去多余空格、统一换行、去噪字符（如识别出的孤立符号）。
- 对比上一轮文本相似度（简单 ratio/编辑距离），小变化不触发翻译。
- 翻译层加节流：例如 150ms 内同一文本不重复翻译。

------

# 5. 模块设计（可以直接作为工程目录结构）

## 5.1 目录结构（建议）

```
local_screen_translator/
  app/
    main.py
    controller.py              # 总控：状态机/线程启停/信号分发
  capture/
    dxcam_backend.py
    bettercam_backend.py       # 可选
  ocr/
    rapidocr_engine.py
    preprocess.py
    postprocess.py
  translate/
    engine_base.py
    argos_engine.py
    ct2_engine.py              # 可选增强
    glossary.py                # 术语表
  ui/
    overlay_window.py          # 透明置顶显示
    selection_window.py        # 全屏选区
    tray.py                    # 托盘菜单
    settings_dialog.py
  utils/
    dpi.py
    hotkeys_win32.py           # RegisterHotKey/WM_HOTKEY
    cache.py                   # LRU
    paths.py                   # 打包路径定位（_MEIPASS）
    logger.py
  assets/
    icons/
    fonts/
  models/
    ocr/
      det.onnx
      rec_en.onnx
      ...
    translate/
      argos/   # *.argosmodel 或已安装包
      ct2/     # CTranslate2 模型目录（可量化）
  config/
    default.json
  licenses/
    THIRD_PARTY_NOTICES.txt
```

------

# 6. 关键模块“怎么写”（到伪代码级别）

## 6.1 捕获模块（DXcam ROI）

- ROI 统一用 `(left, top, right, bottom)`，与 DXcam 的 `region` 一致。[GitHub](https://github.com/ra1nty/DXcam?utm_source=chatgpt.com)
- 允许选择 monitor index（多屏）或按全局坐标捕获。

伪代码：

```
camera = dxcam.create(output_idx=monitor_index)
while running:
    frame = camera.grab(region=roi)  # numpy array
    latest_frame.store(frame)        # 覆盖式
```

（region 语义见 DXcam 文档片段。[GitHub](https://github.com/ra1nty/DXcam?utm_source=chatgpt.com)）

------

## 6.2 OCR 模块（RapidOCR ONNXRuntime）

RapidOCR 在官方示例中展示了典型初始化与推理参数：初始化时可传 det/rec 模型路径和图像 shape；推理时可传 `box_thresh/unclip_ratio/text_score`。[Hugging Face](https://huggingface.co/spaces/RapidAI/RapidOCR/resolve/main/app.py?download=true&utm_source=chatgpt.com)

伪代码：

```
engine = RapidOCR(det_model_path=det_path, rec_model_path=rec_path, rec_img_shape=[3, 48, 320])

ocr_result, infer_elapse = engine(img,
                                  box_thresh=0.5,
                                  unclip_ratio=1.6,
                                  text_score=0.5)
# ocr_result: [(box, text, score), ...]
```

（参数与调用方式参考示例。[Hugging Face](https://huggingface.co/spaces/RapidAI/RapidOCR/resolve/main/app.py?download=true&utm_source=chatgpt.com)）

OCR 后处理建议：

- 按 y 坐标聚类成行（字幕通常单行/双行）。
- 行内按 x 排序拼接，行间用空格或换行连接。
- 去除 score 很低的片段（可选）。

------

## 6.3 翻译模块（两套引擎统一接口）

### 引擎接口

```
class TranslateEngine:
    def translate(self, text: str) -> str: ...
```

### A：Argos Translate（默认）

- 说明：Argos 是离线翻译库，支持 `.argosmodel` 模型包。[PyPI+1](https://pypi.org/project/argostranslate/?utm_source=chatgpt.com)
- GPU（可选）：`ARGOS_DEVICE_TYPE=cuda`。[PyPI](https://pypi.org/project/argostranslate/1.4.0/?utm_source=chatgpt.com)

你可以把 “模型是否已安装” 做成启动自检：缺模型就提示用户导入模型包（离线拷贝也行）。

### B：CTranslate2（增强）

- CTranslate2 文档提供 `ctranslate2.Translator("model/", device="cpu").translate_batch(...)` 的用法示例。[OpenNMT](https://opennmt.net/CTranslate2/python/ctranslate2.Translator.html?utm_source=chatgpt.com)
- 性能：建议 `beam_size=1`；合理 batch；关闭不需要的 scores。[OpenNMT](https://opennmt.net/CTranslate2/performance.html?utm_source=chatgpt.com)
- 量化：转换阶段可设 quantization（如 int8）。[GitHub](https://github.com/OpenNMT/CTranslate2/blob/master/docs/quantization.md?utm_source=chatgpt.com)

------

## 6.4 缓存与术语表（强烈建议）

- **LRU 翻译缓存**：key=normalized 英文，value=中文，容量 2k–20k 可配。
- **术语表**（可选）：对产品名/专有名词，做预替换或后替换（例如 “Save” 在某软件里固定翻译成“存储”而不是“保存”）。

------

# 7. UI 设计（选区层 + 叠加层 + 托盘）

## 7.1 选区层（SelectionWindow）

- 全屏半透明遮罩（多个屏可分别显示或跨屏一个大窗）。
- 鼠标按下记录起点，拖动绘制矩形框；抬起保存 ROI。
- 显示 ROI 尺寸与坐标（便于调试/复现）。
- 选完自动退出并开始捕获。

## 7.2 叠加层（OverlayWindow）

目标：**透明、置顶、不抢焦点、默认穿透输入**，可随时显示翻译结果。

推荐窗口属性组合：

- 透明背景：`Qt.WA_TranslucentBackground`；文档说明 Windows 上还需要 `FramelessWindowHint`。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
- 置顶：`Qt.WindowStaysOnTopHint`。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
- 穿透输入（推荐优先）：`Qt.WindowTransparentForInput`（Qt 文档明确其语义为输入事件像窗口不存在一样穿透；Windows 下仅对无边框或全屏有效）。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
- 组件级鼠标穿透兜底：`Qt.WA_TransparentForMouseEvents`。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)

> “完美体验”建议：
>
> - 默认完全穿透（不干扰用户操作），通过热键切换“可交互模式”（临时允许点击复制/拖动），再热键回到穿透。

显示细节：

- 文字加描边/阴影（对亮背景可读性更好）。
- 自动换行、最大宽度、超出滚动。
- 允许显示“原文（灰色）/译文（白色）”双行模式（可配置）。

## 7.3 托盘与设置

托盘菜单项建议：

- 开始/暂停
- 重新选区
- 显示模式：字幕条 / 浮窗
- OCR 频率档位：高/中/低
- 翻译引擎：Argos / CTranslate2
- 开启/关闭 debug（显示框、显示耗时）

------

# 8. 全局热键（Windows 原生方案，最稳）

推荐用 Win32 的 **RegisterHotKey → WM_HOTKEY** 消息机制：

- RegisterHotKey 文档列出 MOD_ALT/MOD_CONTROL/MOD_SHIFT/MOD_WIN/MOD_NOREPEAT 等修饰键。[Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-registerhotkey?utm_source=chatgpt.com)
- 热键触发时会收到 WM_HOTKEY 消息，文档说明了消息参数含义（修饰键与虚拟键）。[Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/inputdev/wm-hotkey?utm_source=chatgpt.com)

建议默认热键（示例）：

- `Ctrl+Alt+Q`：开始/暂停
- `Ctrl+Alt+S`：选区
- `Ctrl+Alt+T`：切换显示模式
- `Ctrl+Alt+C`：复制译文
- `Ctrl+Alt+↑/↓`：字体大小

> 备注：`MOD_NOREPEAT` 能避免长按导致连发（Windows Vista 不支持，但 Win10/11 可用）。[Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-registerhotkey?utm_source=chatgpt.com)

实现细节：
 用一个单独的线程跑 message loop（或用 Qt 的 nativeEventFilter），收到 WM_HOTKEY 后发 Qt signal 到主线程。

------

# 9. 配置文件（可直接落地用 JSON）

建议 `config/default.json`：

```
{
  "capture": {
    "backend": "dxcam",
    "monitor_index": 0,
    "target_fps": 60,
    "roi": [100, 100, 900, 400]
  },
  "pipeline": {
    "ocr_interval_ms": 100,
    "change_detect": {
      "enabled": true,
      "downsample": 64,
      "mad_threshold": 3.0
    },
    "debounce": {
      "min_translate_interval_ms": 150,
      "text_similarity_threshold": 0.92
    },
    "cache": {
      "enabled": true,
      "max_entries": 5000
    }
  },
  "ocr": {
    "engine": "rapidocr_onnxruntime",
    "det_model_path": "models/ocr/det.onnx",
    "rec_model_path": "models/ocr/rec_en.onnx",
    "box_thresh": 0.5,
    "unclip_ratio": 1.6,
    "text_score": 0.5
  },
  "translate": {
    "engine": "argos",
    "from": "en",
    "to": "zh",
    "argos_device_type": "cpu",
    "ct2": {
      "model_dir": "models/translate/ct2",
      "device": "cpu",
      "beam_size": 1
    }
  },
  "ui": {
    "mode": "subtitle",
    "font_family": "Microsoft YaHei UI",
    "font_size": 22,
    "max_width": 900,
    "opacity": 0.95,
    "click_through": true
  },
  "hotkeys": {
    "toggle_run": "CTRL+ALT+Q",
    "select_roi": "CTRL+ALT+S",
    "toggle_mode": "CTRL+ALT+T",
    "copy": "CTRL+ALT+C",
    "font_up": "CTRL+ALT+UP",
    "font_down": "CTRL+ALT+DOWN"
  }
}
```

------

# 10. CPU-only / GPU 两套落地路径

## 10.1 CPU-only（推荐先交付的稳定版）

- 优点：依赖少、打包简单、兼容性好。
- 适配：中端 CPU 即可达到可用体验（靠跳帧/缓存）。

依赖（示例）：

- dxcam / rapidocr-onnxruntime / argostranslate / PySide6 / opencv-python / numpy

## 10.2 GPU 加速（可选增强版）

### OCR GPU：onnxruntime-gpu

ONNX Runtime 官方文档说明：

- GPU 包需要 CUDA 和 cuDNN；并给出用 pip 安装 runtime DLL 的方式：`pip install onnxruntime-gpu[cuda,cudnn]`。[ONNX Runtime+1](https://onnxruntime.ai/docs/execution-providers/CUDA-ExecutionProvider.html?utm_source=chatgpt.com)

### 翻译 GPU：Argos / CTranslate2

- Argos：设置 `ARGOS_DEVICE_TYPE=cuda` 以启用 GPU。[PyPI](https://pypi.org/project/argostranslate/1.4.0/?utm_source=chatgpt.com)
- CTranslate2：选择 `device="cuda"` + `compute_type="float16"`（并可用 int8 量化模型减压）。量化能力见文档。[GitHub+1](https://github.com/OpenNMT/CTranslate2/blob/master/docs/quantization.md?utm_source=chatgpt.com)

> 注意：GPU 版最大工程风险不是代码，而是 **CUDA/cuDNN/驱动/运行时 DLL** 的版本兼容。建议做“自动回退”：GPU 初始化失败→自动切 CPU 并提示用户。ONNX Runtime 文档也强调 GPU 包依赖 CUDA/cuDNN。[ONNX Runtime](https://onnxruntime.ai/docs/install/?utm_source=chatgpt.com)

------

# 11. 打包发布（Windows exe）

## 11.1 工具：PyInstaller（one-folder 推荐）

PyInstaller 文档说明：可以把 Python 应用及依赖打包成“文件夹或单文件”，用户无需安装 Python。[PyInstaller+1](https://pyinstaller.org/en/stable/operating-mode.html?utm_source=chatgpt.com)

**强烈建议 one-folder**：模型文件大、未来可能更新，one-file 每次启动解压慢且不利于模型管理。

## 11.2 模型/资源文件如何在打包后访问

PyInstaller 运行时文档说明：启动后会设置 `sys.frozen`，并把 bundle 路径放到 `sys._MEIPASS`。[PyInstaller](https://pyinstaller.org/en/stable/runtime-information.html?utm_source=chatgpt.com)

你的 `utils/paths.py` 应提供：

- 开发态：相对项目路径
- 打包态：相对 `sys._MEIPASS` 的资源路径

------

# 12. 验收测试与质量保障（“完美”靠这一段）

## 12.1 自动化测试建议

- **单元测试**：文本 normalize、行合并、缓存命中、配置读写。
- **回放测试**：录制 ROI 视频帧序列（png 或 mp4 解码）作为固定输入，跑 OCR+翻译对比输出。
- **性能基准**：记录每阶段耗时（capture/ocr/translate/ui），输出到日志或 debug 面板。

## 12.2 验收清单（建议写进 PRD/合同）

- DPI 125%/150% 下选区捕获准确（无明显偏移）。
- 多屏情况下 ROI 不漂移（跨屏选区可正常工作）。
- 叠加层置顶不抢焦点、默认可点击穿透（用户仍可操作原应用）。
- 连续 30 分钟运行不崩溃、不内存持续增长（无泄露）。
- 断网可用（翻译不依赖网络）。
- 打包后在干净 Windows 环境可运行（无需安装 Python）。

------

# 13. 已知风险与兜底策略（把坑提前写进方案=“完美”）

1. **受保护内容无法捕获（DRM 视频/某些全屏硬件保护画面）**
   - 表现：黑屏/空白帧。
   - 兜底：提示用户改用无保护来源/窗口模式；提供捕获 backend 切换（DXcam↔MSS/BetterCam）。
2. **OCR 抖动导致译文闪烁**
   - 兜底：相似度阈值 + 最小翻译间隔 + 缓存；必要时对字幕做“稳定窗口”（例如连续两次一致才更新）。
3. **GPU 依赖地狱**（CUDA/cuDNN 版本）
   - 兜底：GPU 初始化失败自动回退 CPU，并在设置里提示“当前运行在 CPU 模式”。
4. **透明叠加层点击穿透兼容性**
   - 首选 Qt 的 `Qt.WindowTransparentForInput`（文档明确其语义与 Windows 限制）。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
   - 兜底用 `Qt.WA_TransparentForMouseEvents`（组件级）。[Qt Documentation](https://doc.qt.io/qtforpython-6/PySide6/QtCore/Qt.html)
   - 若极端情况仍不穿透，再考虑原生 WS_EX_TRANSPARENT（平台相关，建议后置）。

------

# 14. “最推荐的版本路线”（不问你确认，直接给最优默认）

- **V1（最稳上线）**：CPU-only、字幕条模式、DXcam + RapidOCR + Argos、全局热键、托盘、DPI manifest、跳帧+缓存。
- **V2（体验加强）**：浮窗模式、术语表、可交互/穿透一键切换、更多 OCR 参数面板、调试可视化（显示识别框）。
- **V3（性能版）**：onnxruntime-gpu（OCR）、CTranslate2（翻译）+ int8/FP16、BetterCam 可选、模型热更新。